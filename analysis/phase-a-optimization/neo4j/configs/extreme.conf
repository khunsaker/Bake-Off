# Neo4j Extreme Configuration
# Shark Bake-Off: Extreme Optimization Variant (Benchmark-Specific)
# Target: 16GB RAM, 8-core CPU, maximum performance

# ============================================================================
# MEMORY SETTINGS (AGGRESSIVE)
# ============================================================================

# Java Heap (25% of RAM)
dbms.memory.heap.initial_size=4G
dbms.memory.heap.max_size=4G

# Page Cache (62.5% of RAM - push limits for read-heavy workload)
dbms.memory.pagecache.size=10G

# Transaction Memory (maximum for high concurrency)
dbms.memory.transaction.total.max=10G

# ============================================================================
# QUERY OPTIMIZATION (MAXIMUM CACHING)
# ============================================================================

# Query Cache (cache all benchmark queries)
dbms.query_cache_size=10000

# Cypher optimization (strict mode)
cypher.hints_error=true
cypher.lenient_create_relationship=false

# ============================================================================
# CONCURRENCY (MAXIMUM PARALLELISM)
# ============================================================================

# Bolt worker threads (aggressive for 8-core system)
dbms.threads.worker_count=20

# ============================================================================
# CONNECTION MANAGEMENT
# ============================================================================

# Bolt connector
dbms.connector.bolt.enabled=true
dbms.connector.bolt.listen_address=0.0.0.0:7687

# HTTP connector
dbms.connector.http.enabled=true
dbms.connector.http.listen_address=0.0.0.0:7474

# ============================================================================
# TRANSACTION LOG (OPTIMIZE FOR THROUGHPUT)
# ============================================================================

# Transaction log rotation (large to reduce rotation overhead)
dbms.tx_log.rotation.size=2G

# Checkpoint interval (infrequent for benchmark)
dbms.checkpoint.interval.time=60m
dbms.checkpoint.interval.tx=1000000

# ============================================================================
# TIMEOUTS (GENEROUS FOR COMPLEX QUERIES)
# ============================================================================

# Transaction timeout
dbms.transaction.timeout=300s

# Lock acquisition timeout
dbms.lock.acquisition.timeout=120s

# ============================================================================
# LOGGING (DISABLED FOR MAXIMUM PERFORMANCE)
# ============================================================================

# Disable query logging
dbms.logs.query.enabled=false

# Minimal logging
dbms.logs.debug.level=ERROR

# ============================================================================
# INDEXING (AGGRESSIVE SAMPLING)
# ============================================================================

# Background index sampling
dbms.index_sampling.background_enabled=true

# Maximum sample size
dbms.index_sampling.sample_size_limit=10000000

# Index creation parallelism
dbms.index.default.parallel.creation=true

# ============================================================================
# SECURITY
# ============================================================================

# Authentication
dbms.security.auth_enabled=true

# APOC procedures (unrestricted for advanced queries)
dbms.security.procedures.unrestricted=apoc.*
dbms.security.procedures.whitelist=apoc.*

# ============================================================================
# JVM TUNING (AGGRESSIVE GC)
# ============================================================================

# G1 Garbage Collector
dbms.jvm.additional=-XX:+UseG1GC

# Aggressive GC tuning
dbms.jvm.additional=-XX:MaxGCPauseMillis=150
dbms.jvm.additional=-XX:InitiatingHeapOccupancyPercent=40
dbms.jvm.additional=-XX:G1ReservePercent=15
dbms.jvm.additional=-XX:+ParallelRefProcEnabled

# Large pages (if supported by OS)
dbms.jvm.additional=-XX:+UseTransparentHugePages

# String deduplication (save memory)
dbms.jvm.additional=-XX:+UseStringDeduplication

# ============================================================================
# PERFORMANCE (MAXIMUM)
# ============================================================================

# Enable metrics
metrics.enabled=true

# Disable unnecessary features for benchmark
dbms.read_only=false

# ============================================================================
# EXPERIMENTAL (USE WITH CAUTION)
# ============================================================================

# Bolt thread pool size (override auto-detection)
dbms.connector.bolt.thread_pool_min_size=10
dbms.connector.bolt.thread_pool_max_size=40

# Query execution parallelism (if supported)
# cypher.default_parallel_execution=true
